
version: '1.0'
# stages:
  # - prepare
  # - build
#   - deploy
steps:
  main_clone:
    title: Cloning main repository...
    type: git-clone
    repo: '${{CF_REPO_OWNER}}/${{CF_REPO_NAME}}'
    revision: '${{CF_REVISION}}'
    # stage: prepare
  Build:
    title: Building Docker Image
    type: build
    # stage: build
    image_name: simple-server
    working_directory: ./
    tag: '${{CF_SHORT_REVISION}}'
    dockerfile: Dockerfile
  Push:
    type: push
    title: Push to Docker Hub
    description: Free text description
    candidate: palson/http-server:'${{CF_SHORT_REVISION}}'
    tag: '${{CF_SHORT_REVISION}}'
    image_name: palson/http-server
    registry: dockerhub
  Tests:
    title: Running tests
    # image: '${{MyAppDockerImage}}'
    image: alpine
    # image: 'cf-registry.codefresh.svc:5000/my-app-image:master'
    commands:
      - env
#   Deploy:
    # title: deploying to cluster
    # type: deploy
    # arguments:
      # kind: kubernetes
      # cluster: issue-66
      # namespace: testserver
#       service: simplego
